
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Emoji Dungeon - Full Game</title>
  <style>
    body { background: #111; color: #0f0; font-family: monospace; display: flex; }
    #leftPanel { display: flex; flex-direction: column; }
    #game { white-space: pre; padding: 10px; font-size: 16px; line-height: 1.2; height: 360px; overflow-y: auto; }
    #status { white-space: pre-wrap; padding: 10px; height: 100px; overflow-y: auto; background: #222; border-top: 1px solid #0f0; }
    #command { width: 100%; background: #222; color: #0f0; border: 1px solid #0f0; padding: 4px; font-family: monospace; }
    #sidebar { width: 260px; padding: 10px; border-left: 2px solid #0f0; }
    select, button { width: 100%; background: #222; color: #0f0; font-family: monospace; margin-bottom: 10px; }
    #inventory, #equipment, #spells { margin-top: 10px; white-space: pre-wrap; }
  </style>
</head>
<body>
  <div id="leftPanel">
    <select id="themeSelect">
      <option value="fantasy">ğŸ§™ Fantasy</option>
      <option value="scifi">ğŸ¤– Sci-Fi</option>
      <option value="horror">ğŸ§Ÿ Horror</option>
    </select>
    <div id="game"></div>
    <div id="status"></div>
    <input id="command" placeholder="cast ignis east / fire west / equip sword / examine / talk" />
    <button onclick="saveGame()">ğŸ’¾ Save Game</button>
    <button onclick="loadGame()">ğŸ“‚ Load Game</button>
  </div>
  <div id="sidebar">
    <h3>Legend</h3>
    <div id="legend"></div>
    <h4>Equipment</h4>
    <div id="equipment"></div>
    <h4>Spells</h4>
    <div id="spells"></div>
    <h4>Inventory</h4>
    <div id="inventory"></div>
  </div>
<script>
// Full JavaScript logic for Emoji Dungeon Game
// Includes: movement, rendering, combat, inventory, equipment, spells, traps, NPCs, projectiles, save/load

// ========== GAME STATE ==========
const roomSize = { width: 20, height: 10 };
const gameDisplay = document.getElementById("game");
const commandInput = document.getElementById("command");
const themeSelect = document.getElementById("themeSelect");
const legendDiv = document.getElementById("legend");
const inventoryDiv = document.getElementById("inventory");
const equipmentDiv = document.getElementById("equipment");
const spellsDiv = document.getElementById("spells");
const statusDiv = document.getElementById("status");

const directions = { north: [0, -1], south: [0, 1], west: [-1, 0], east: [1, 0] };

const themes = {
  fantasy: { player: "ğŸ§™", wall: "ğŸŸ«", floor: "â¬›", exit: "ğŸšª", enemy: "ğŸ‘¹", chest: "ğŸ", trap: "ğŸª¤", npc: "ğŸ¤", fireball: "ğŸ”¥", arrow: "ğŸ¹" },
  scifi: { player: "ğŸ‘¨â€ğŸš€", wall: "ğŸ§±", floor: "â—¼ï¸", exit: "ğŸ›¸", enemy: "ğŸ¤–", chest: "ğŸ“¦", trap: "ğŸ’£", npc: "ğŸ¤–", fireball: "ğŸ’¥", arrow: "ğŸ”«" },
  horror: { player: "ğŸ§Ÿ", wall: "ğŸª¦", floor: "â¬œ", exit: "ğŸ•³ï¸", enemy: "ğŸ•·ï¸", chest: "ğŸª™", trap: "ğŸª¤", npc: "ğŸ§›", fireball: "ğŸ§¨", arrow: "ğŸª“" }
};

let currentTheme = "fantasy";
let floorMap = {};
let currentRoom = "0,0";

let player = {
  x: 1, y: 1, hp: 20, maxHp: 20, exp: 0, level: 1, room: "0,0",
  inventory: ["bow", "sword", "armor", "spell: ignis"],
  spells: ["ignis"], weapon: "sword", ranged: "bow", armor: "armor"
};

// ========== UI FUNCTIONS ==========
function updateUI() {
  const t = themes[currentTheme];
  legendDiv.innerHTML = `${t.player}=Player<br>${t.enemy}=Enemy<br>${t.wall}=Wall<br>${t.floor}=Floor<br>${t.exit}=Exit<br>${t.chest}=Chest<br>${t.npc}=NPC<br>${t.trap}=Trap`;
  equipmentDiv.textContent = `Melee: ${player.weapon}\nRanged: ${player.ranged}\nArmor: ${player.armor}`;
  spellsDiv.textContent = player.spells.join("\n");
  inventoryDiv.textContent = player.inventory.filter(i => !i.startsWith("spell:") && i !== player.weapon && i !== player.ranged && i !== player.armor).join("\n");
}

function log(msg) {
  statusDiv.textContent += msg + "\n";
  statusDiv.scrollTop = statusDiv.scrollHeight;
}

function renderRoom(extra = []) {
  const t = themes[currentTheme], room = floorMap[player.room];
  let output = "";
  for (let y = 0; y < roomSize.height; y++) {
    for (let x = 0; x < roomSize.width; x++) {
      let tile = room.layout[y][x];
      let char = t[tile] || "?";
      if (player.x === x && player.y === y) char = t.player;
      else if (room.enemies.find(e => e.x === x && e.y === y)) char = t.enemy;
      else if (room.npcs?.find(n => n.x === x && n.y === y)) char = t.npc;
      const override = extra.find(p => p[0] === x && p[1] === y);
      output += override ? override[2] : char;
    }
    output += "\n";
  }
  output += `HP: ${player.hp}/${player.maxHp}  LVL: ${player.level}  EXP: ${player.exp}`;
  gameDisplay.textContent = output;
  updateUI();
}
</body>
</html>
